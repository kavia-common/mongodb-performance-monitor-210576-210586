{"is_source_file": true, "format": "Python", "description": "This Python source file defines configuration loading logic for a MongoDB performance monitoring backend. It includes functions to read environment variables, parse a MongoDB URI from a file, mask credentials for logging, and construct a dataclass containing various configuration parameters related to metrics collection, rollups, alerts, and recommendations.", "external_files": ["mongodb_performance_monitor-210576-210587/mongodb_instance/db_connection.txt"], "external_methods": ["os.getenv", "os.path.exists", "re.search", "re.sub", "Path.resolve", "Path.parents", "Path.read_text"], "published": ["load_config", "BackendConfig"], "classes": [{"name": "BackendConfig", "description": "Immutable dataclass holding configuration parameters for the backend, loaded from environment variables and configuration files."}], "methods": [{"name": "int _env_int(name: str, default: int)", "description": "Parses an integer environment variable with a default fallback.", "scope": "", "scopeKind": ""}, {"name": "bool _env_bool(name: str, default: bool = False)", "description": "Parses a boolean environment variable with a default fallback.", "scope": "", "scopeKind": ""}, {"name": "int _clamp_int(v: int, lo: int, hi: int)", "description": "Clamps an integer value within specified bounds.", "scope": "", "scopeKind": ""}, {"name": "Path _db_connection_candidate_path()", "description": "Computes the expected path to the mongodb_instance/db_connection.txt file based on the script's location.", "scope": "", "scopeKind": ""}, {"name": "Optional[str] _parse_mongo_uri_from_db_connection_text(text: str)", "description": "Extracts a MongoDB URI from the text content of the db_connection.txt file.", "scope": "", "scopeKind": ""}, {"name": "Tuple[Optional[str],Optional[str]] _read_mongo_uri_from_db_connection_file()", "description": "Reads the mongo URI and path from the configured connection file, handling absence and errors.", "scope": "", "scopeKind": ""}, {"name": "str _sanitize_mongo_uri_for_logs(uri: str)", "description": "Masks credentials in MongoDB URIs to prevent secret leakage in logs.", "scope": "", "scopeKind": ""}, {"name": "BackendConfig load_config()", "description": "Main function to load the backend configuration, attempting to read from a file and environment, validating and preparing all parameters.", "scope": "", "scopeKind": ""}], "calls": ["os.getenv", "re.search", "re.sub", "Path.resolve", "Path.parents", "Path.read_text", "_parse_mongo_uri_from_db_connection_text", "_read_mongo_uri_from_db_connection_file", "logger.info", "logger.exception"], "search-terms": ["BackendConfig", "load_config", "mongodb_instance/db_connection.txt", "metrics_sampling_interval_sec", "metrics_raw_ttl_seconds", "metrics_rollup_enabled", "metrics_rollup_ttl_seconds", "recs_default_ttl_days"], "state": 2, "file_id": 21, "knowledge_revision": 82, "git_revision": "d74cfd9e45156ce797a4585d816d9a2c1367cabf", "revision_history": [{"45": ""}, {"58": "d21f925c1fc950dcc3050ff0205bcb57f4237af9"}, {"65": "d21f925c1fc950dcc3050ff0205bcb57f4237af9"}, {"78": "09410bea15e21a7e3c9b73c6e17854e1898bd9de"}, {"82": "d74cfd9e45156ce797a4585d816d9a2c1367cabf"}], "ctags": [{"_type": "tag", "name": "BackendConfig", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/config.py", "pattern": "/^class BackendConfig:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_clamp_int", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/config.py", "pattern": "/^def _clamp_int(v: int, lo: int, hi: int) -> int:$/", "language": "Python", "typeref": "typename:int", "kind": "function", "signature": "(v: int, lo: int, hi: int)"}, {"_type": "tag", "name": "_db_connection_candidate_path", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/config.py", "pattern": "/^def _db_connection_candidate_path() -> Path:$/", "language": "Python", "typeref": "typename:Path", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_env_bool", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/config.py", "pattern": "/^def _env_bool(name: str, default: bool = False) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(name: str, default: bool = False)"}, {"_type": "tag", "name": "_env_int", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/config.py", "pattern": "/^def _env_int(name: str, default: int) -> int:$/", "language": "Python", "typeref": "typename:int", "kind": "function", "signature": "(name: str, default: int)"}, {"_type": "tag", "name": "_parse_mongo_uri_from_db_connection_text", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/config.py", "pattern": "/^def _parse_mongo_uri_from_db_connection_text(text: str) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "function", "signature": "(text: str)"}, {"_type": "tag", "name": "_read_mongo_uri_from_db_connection_file", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/config.py", "pattern": "/^def _read_mongo_uri_from_db_connection_file() -> Tuple[Optional[str], Optional[str]]:$/", "language": "Python", "typeref": "typename:Tuple[Optional[str],Optional[str]]", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_sanitize_mongo_uri_for_logs", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/config.py", "pattern": "/^def _sanitize_mongo_uri_for_logs(uri: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(uri: str)"}, {"_type": "tag", "name": "load_config", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/config.py", "pattern": "/^def load_config() -> BackendConfig:$/", "language": "Python", "typeref": "typename:BackendConfig", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "logger", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/config.py", "pattern": "/^logger = logging.getLogger(__name__)$/", "language": "Python", "kind": "variable"}], "hash": "06ebc4ea97cd3f2d7c035789ddca96e5", "format-version": 4, "code-base-name": "performance_monitor_backend", "filename": "performance_monitor_backend/src/api/config.py", "fields": [{"name": "logger = logging.getLogger(__name__)", "scope": "", "scopeKind": "", "description": "unavailable"}]}