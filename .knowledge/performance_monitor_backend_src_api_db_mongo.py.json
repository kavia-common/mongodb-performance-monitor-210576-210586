{"is_source_file": true, "format": "Python", "description": "This file defines a MongoDB connection manager for a performance monitoring backend. It includes classes and methods to manage app and monitored target MongoDB clients, setup indexes, and access specific collections within the 'perfmon' database.", "external_files": ["pymongo", "pymongo.collection", "pymongo.database"], "external_methods": ["MongoClient()", "MongoClient.close()", "Collection.create_index()", "Database.__getitem__()"], "published": ["MongoCollections", "MongoManager"], "classes": [{"name": "MongoCollections", "description": "A dataclass wrapper for the application's MongoDB collections."}, {"name": "MongoManager", "description": "A class managing MongoDB connections, including app-level and target-specific clients, with index setup and resource cleanup."}], "methods": [{"name": "__init__(self, app_mongo_uri: str)", "description": "Initializes the MongoManager with the application's MongoDB URI.", "scope": "MongoManager", "scopeKind": "class"}, {"name": "None connect_app(self)", "description": "Establishes the MongoDB client connection for the application's database, if not already connected.", "scope": "MongoManager", "scopeKind": "class"}, {"name": "None close(self)", "description": "Closes all MongoDB clients, both app and target clients, handling exceptions and resource cleanup.", "scope": "MongoManager", "scopeKind": "class"}, {"name": "Database app_db(self)", "description": "Returns the database handle for 'perfmon', initializing the app client if necessary.", "scope": "MongoManager", "scopeKind": "class"}, {"name": "MongoCollections collections(self)", "description": "Returns an object containing references to the main collections within the 'perfmon' database.", "scope": "MongoManager", "scopeKind": "class"}, {"name": "None init_indexes(self)", "description": "Creates necessary indexes on collections to optimize queries, idempotently.", "scope": "MongoManager", "scopeKind": "class"}, {"name": "MongoClient target_client(self, instance_id: str, uri: str)", "description": "Retrieves or creates a cached MongoClient for a specific monitored instance based on its ID and URI.", "scope": "MongoManager", "scopeKind": "class"}], "calls": ["MongoClient()", "MongoClient.close()", "Collection.create_index()", "Database.__getitem__()"], "search-terms": ["MongoManager", "performance_monitor_backend", "mongodb connection", "perfmon database", "collections", "indexes"], "state": 2, "file_id": 22, "knowledge_revision": 59, "git_revision": "d21f925c1fc950dcc3050ff0205bcb57f4237af9", "revision_history": [{"55": "ac108bb99020dc67cfe8a133c3fe05fd9ce788f5"}, {"59": "d21f925c1fc950dcc3050ff0205bcb57f4237af9"}], "ctags": [{"_type": "tag", "name": "APP_DB_NAME", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/db/mongo.py", "pattern": "/^APP_DB_NAME = \"perfmon\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "MongoCollections", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/db/mongo.py", "pattern": "/^class MongoCollections:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "MongoManager", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/db/mongo.py", "pattern": "/^class MongoManager:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/db/mongo.py", "pattern": "/^    def __init__(self, app_mongo_uri: str):$/", "language": "Python", "kind": "member", "signature": "(self, app_mongo_uri: str)", "scope": "MongoManager", "scopeKind": "class"}, {"_type": "tag", "name": "app_db", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/db/mongo.py", "pattern": "/^    def app_db(self) -> Database:$/", "language": "Python", "typeref": "typename:Database", "kind": "member", "signature": "(self)", "scope": "MongoManager", "scopeKind": "class"}, {"_type": "tag", "name": "close", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/db/mongo.py", "pattern": "/^    def close(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "MongoManager", "scopeKind": "class"}, {"_type": "tag", "name": "collections", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/db/mongo.py", "pattern": "/^    def collections(self) -> MongoCollections:$/", "language": "Python", "typeref": "typename:MongoCollections", "kind": "member", "signature": "(self)", "scope": "MongoManager", "scopeKind": "class"}, {"_type": "tag", "name": "connect_app", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/db/mongo.py", "pattern": "/^    def connect_app(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "MongoManager", "scopeKind": "class"}, {"_type": "tag", "name": "init_indexes", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/db/mongo.py", "pattern": "/^    def init_indexes(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "MongoManager", "scopeKind": "class"}, {"_type": "tag", "name": "logger", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/db/mongo.py", "pattern": "/^logger = logging.getLogger(__name__)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "target_client", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/db/mongo.py", "pattern": "/^    def target_client(self, instance_id: str, uri: str) -> MongoClient:$/", "language": "Python", "typeref": "typename:MongoClient", "kind": "member", "signature": "(self, instance_id: str, uri: str)", "scope": "MongoManager", "scopeKind": "class"}], "hash": "daf4c3d4ebca2a24288cb9cabd339829", "format-version": 4, "code-base-name": "performance_monitor_backend", "filename": "performance_monitor_backend/src/api/db/mongo.py", "fields": [{"name": "APP_DB_NAME = \"perfmon\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "logger = logging.getLogger(__name__)", "scope": "", "scopeKind": "", "description": "unavailable"}]}