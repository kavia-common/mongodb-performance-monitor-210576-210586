{"is_source_file": true, "format": "Python", "description": "This file defines a MongoDB connection manager class for managing multiple MongoDB clients, their collections, and indexing, specifically for a performance monitoring backend.", "external_files": ["pymongo", "pymongo.collection", "pymongo.database"], "external_methods": ["pymongo.MongoClient", "pymongo.collection.Collection", "pymongo.database.Database"], "published": ["MongoCollections", "MongoManager", "APP_DB_NAME"], "classes": [{"name": "MongoCollections", "description": "A data class that wraps the main MongoDB collections used in the application (instances, metrics_samples, alerts, recommendations)."}, {"name": "MongoManager", "description": "A class that manages MongoDB connections and collections, maintaining thread-safety, connection pooling, and index creation for performance monitoring data."}], "methods": [{"name": "None connect_app(self)", "description": "Initializes the application's main MongoClient if it is not already connected.", "scope": "MongoManager", "scopeKind": "class"}, {"name": "None close(self)", "description": "Closes all MongoClient instances: the app's main client and any cached target clients, handling exceptions and cleanup.", "scope": "MongoManager", "scopeKind": "class"}, {"name": "Database app_db(self)", "description": "Returns the Database object for the 'perfmon' database, establishing connection if needed.", "scope": "MongoManager", "scopeKind": "class"}, {"name": "MongoCollections collections(self)", "description": "Provides access to the application's collections wrapped in the MongoCollections data class.", "scope": "MongoManager", "scopeKind": "class"}, {"name": "None init_indexes(self)", "description": "Creates essential indexes on collections if they don't already exist, optimizing query performance.", "scope": "MongoManager", "scopeKind": "class"}, {"name": "MongoClient target_client(self, instance_id: str, uri: str)", "description": "Retrieves or creates a cached MongoClient for a specific monitored instance identified by instance_id and uri.", "scope": "MongoManager", "scopeKind": "class"}, {"name": "__init__(self, app_mongo_uri: str)", "scope": "MongoManager", "scopeKind": "class", "description": "unavailable"}], "calls": ["MongoClient", "MongoClient.close", "Database.__getitem__", "Collection.create_index"], "search-terms": ["MongoManager", "collections index setup", "thread-safe MongoDB client manager", "performance monitoring MongoDB", "multi-client connection cache"], "state": 2, "file_id": 22, "knowledge_revision": 55, "git_revision": "ac108bb99020dc67cfe8a133c3fe05fd9ce788f5", "ctags": [{"_type": "tag", "name": "APP_DB_NAME", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/db/mongo.py", "pattern": "/^APP_DB_NAME = \"perfmon\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "MongoCollections", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/db/mongo.py", "pattern": "/^class MongoCollections:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "MongoManager", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/db/mongo.py", "pattern": "/^class MongoManager:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/db/mongo.py", "pattern": "/^    def __init__(self, app_mongo_uri: str):$/", "language": "Python", "kind": "member", "signature": "(self, app_mongo_uri: str)", "scope": "MongoManager", "scopeKind": "class"}, {"_type": "tag", "name": "app_db", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/db/mongo.py", "pattern": "/^    def app_db(self) -> Database:$/", "language": "Python", "typeref": "typename:Database", "kind": "member", "signature": "(self)", "scope": "MongoManager", "scopeKind": "class"}, {"_type": "tag", "name": "close", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/db/mongo.py", "pattern": "/^    def close(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "MongoManager", "scopeKind": "class"}, {"_type": "tag", "name": "collections", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/db/mongo.py", "pattern": "/^    def collections(self) -> MongoCollections:$/", "language": "Python", "typeref": "typename:MongoCollections", "kind": "member", "signature": "(self)", "scope": "MongoManager", "scopeKind": "class"}, {"_type": "tag", "name": "connect_app", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/db/mongo.py", "pattern": "/^    def connect_app(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "MongoManager", "scopeKind": "class"}, {"_type": "tag", "name": "init_indexes", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/db/mongo.py", "pattern": "/^    def init_indexes(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "MongoManager", "scopeKind": "class"}, {"_type": "tag", "name": "logger", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/db/mongo.py", "pattern": "/^logger = logging.getLogger(__name__)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "target_client", "path": "/home/kavia/workspace/code-generation/mongodb-performance-monitor-210576-210586/performance_monitor_backend/src/api/db/mongo.py", "pattern": "/^    def target_client(self, instance_id: str, uri: str) -> MongoClient:$/", "language": "Python", "typeref": "typename:MongoClient", "kind": "member", "signature": "(self, instance_id: str, uri: str)", "scope": "MongoManager", "scopeKind": "class"}], "hash": "8ab53463f7779478210ff51812e03eb9", "format-version": 4, "code-base-name": "performance_monitor_backend", "filename": "performance_monitor_backend/src/api/db/mongo.py", "fields": [{"name": "APP_DB_NAME = \"perfmon\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "logger = logging.getLogger(__name__)", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"55": "ac108bb99020dc67cfe8a133c3fe05fd9ce788f5"}]}